<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HISAB PREM PDF</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com.firebasejs/9.6.1/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-messaging.js"></script>
</head>
<body>
    <h1>Welcome to HISAB PREM PDF</h1>
    <div id="user-signed-out" class="hidden">
        <h2>Please sign in</h2>
        <button id="signin-button">Sign In</button>
    </div>
    <div id="user-signed-in" class="hidden">
        <h2>Welcome, <span id="user-name"></span></h2>
        <button id="signout-button">Sign Out</button>
        <div id="entry-form">
            <input type="text" id="entry-input" placeholder="Enter your entry" />
            <button id="add-entry-button">Add Entry</button>
        </div>
        <div id="entry-list"></div>
        <button id="export-pdf-button">Export PDF</button>
        <div id="chart-container"></div>
    </div>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyA_prff3ZJmhtt_I2RFfbfJsuym-29O7ng",
            authDomain: "hisabprem.firebaseapp.com",
            projectId: "hisabprem",
            storageBucket: "hisabprem.appspot.com",
            messagingSenderId: "299571413492",
            appId: "1:299571413492:web:de65e2a8d3544060fcb9a1"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // User Authentication
        document.getElementById('signin-button').addEventListener('click', () => {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider);
        });

        document.getElementById('signout-button').addEventListener('click', () => {
            auth.signOut();
        });

        auth.onAuthStateChanged(user => {
            if (user) {
                document.getElementById('user-name').textContent = user.displayName;
                document.getElementById('user-signed-out').classList.add('hidden');
                document.getElementById('user-signed-in').classList.remove('hidden');
                loadEntries();
            } else {
                document.getElementById('user-signed-out').classList.remove('hidden');
                document.getElementById('user-signed-in').classList.add('hidden');
            }
        });

        // Firestore CRUD Operations
        function loadEntries() {
            const entryList = document.getElementById('entry-list');
            entryList.innerHTML = '';
            db.collection('entries').onSnapshot(snapshot => {
                snapshot.forEach(doc => {
                    const entry = document.createElement('div');
                    entry.textContent = doc.data().text;
                    entryList.appendChild(entry);
                });
            });
        }

        document.getElementById('add-entry-button').addEventListener('click', () => {
            const entryText = document.getElementById('entry-input').value;
            db.collection('entries').add({ text: entryText });
        });

        // PDF Export and Chart generation can be implemented here.
    </script>
</body>
</html>